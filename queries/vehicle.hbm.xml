<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
"-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">

<hibernate-mapping>
  <sql-query name="app.vehicle.get.all">
    <![CDATA[
      SELECT
        "ID" AS "vehicleId",
        "TYPE" AS "vehicleType",
        "NAME" AS "vehicleName"
      FROM "M_VEHICLE_TYPE"
      WHERE
        "DEL_FLG" = 0
      ORDER BY
        "DISP_ORD"
    ]]>
  </sql-query>
  <sql-query name="app.vehicle.save">
      <![CDATA[
        INSERT INTO "T_USER_VEHICLE"
        (
          "ID",
          "VEHICLE_ID",
          "VEHICLE_NO",
          "USER_ID",
          "DEL_FLG",
          "INS_DT",
          "INS_BY",
          "NAME"
        )
         VALUES(
           :id,
           :vehicleId,
           :vehicleNo,
           :userId,
           0,
           CURRENT_TIMESTAMP,
           :serviceCode,
           :vehicleName
         )
      ]]>
  </sql-query>
  <sql-query name="app.vehicle.get.uservehicle">
    <![CDATA[
        select
          uservehicle."ID" AS "userVehicleId",
          uservehicle."VEHICLE_ID" AS "vehicleId",
          uservehicle."VEHICLE_NO" AS "vehicleNo",
          uservehicle."NAME" AS "vehicleName",
          vehicletype."TYPE" AS "vehicleType",
          vehicletype."NAME" AS "vehicleTypeName"
          from "T_USER_VEHICLE" as uservehicle
        JOIN "M_VEHICLE_TYPE" as vehicletype
        ON (
          uservehicle."VEHICLE_ID" = vehicletype."ID"
        )
        where
          uservehicle."DEL_FLG" = 0
          AND vehicletype."DEL_FLG" = 0
          AND uservehicle."USER_ID" = :userId
    ]]>
  </sql-query>
  <sql-query name="app.vehicle.delete.uservehicle">
      <![CDATA[
        UPDATE "T_USER_VEHICLE"
        SET
          "DEL_FLG" = 1,
          "UPD_DT" = CURRENT_TIMESTAMP,
          "UPD_BY" = :serviceCode
        WHERE
         "ID" = :userVehicleId
      ]]>
  </sql-query>
  <sql-query name="app.vehicle.update.uservehicle">
      <![CDATA[
        UPDATE "T_USER_VEHICLE"
        SET
          "VEHICLE_ID" = :vehicleId,
          "VEHICLE_NO" = :vehicleNo,
          "NAME" = :vehicleName,
          "UPD_DT" = CURRENT_TIMESTAMP,
          "UPD_BY" = :serviceCode
        WHERE
         "ID" = :userVehicleId
      ]]>
  </sql-query>
</hibernate-mapping>
